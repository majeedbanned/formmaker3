# سیستم نمره‌دهی (Grading System)

سیستم نمره‌دهی یک ابزار جامع برای مدیریت و ثبت نمرات دانش‌آموزان است که با رابط کاربری بهینه و جریان کاری ساده طراحی شده است.

## ویژگی‌های کلیدی

### 🎯 جریان کاری چندمرحله‌ای (Multi-Step Wizard)

- **مرحله ۱**: انتخاب کلاس از میان کلاس‌هایی که معلم در آن تدریس می‌کند
- **مرحله ۲**: انتخاب درس از میان دروسی که معلم در آن کلاس تدریس می‌کند
- **مرحله ۳**: وارد کردن عنوان برای ثبت نمره (مثل "آزمون میان‌ترم")
- **مرحله ۴**: ثبت نمرات دانش‌آموزان به صورت سریع و بهینه
- **مرحله ۵**: بررسی و ذخیره نهایی نمرات

### ⚡ ثبت سریع نمرات

- **کلیدهای میانبر**: استفاده از Enter، Tab و کلیدهای جهت‌دار برای حرکت سریع
- **اعتبارسنجی لحظه‌ای**: بررسی نمرات در محدوده ۰ تا ۲۰
- **پیشرفت بصری**: نمایش پیشرفت ثبت نمرات و آمار لحظه‌ای
- **نمرات اعشاری**: پشتیبانی از نمرات اعشاری (مثل ۱۵.۵)

### 📊 آمار و گزارش‌گیری

- **میانگین کلاس**: محاسبه خودکار میانگین نمرات
- **آمار قبولی/مردودی**: نمایش تعداد دانش‌آموزان قبول و مردود
- **بالاترین و پایین‌ترین نمره**: نمایش محدوده نمرات
- **نمودارهای بصری**: نمایش آمار به صورت کارت‌های رنگی

### 🔐 کنترل دسترسی

- **معلمان**: فقط کلاس‌ها و نمرات خود را مشاهده و ویرایش می‌کنند
- **مدیر مدرسه**: دسترسی به تمام نمرات و آمار کل مدرسه
- **احراز هویت**: بررسی دقیق مجوزهای دسترسی در تمام مراحل

### ✏️ ویرایش و مدیریت

- **ویرایش نمرات**: امکان ویرایش نمرات ثبت شده
- **تاریخچه تغییرات**: ردیابی زمان ایجاد و آخرین ویرایش
- **جستجو و فیلتر**: جستجو در عنوان، کلاس، درس و نام معلم

## ساختار فایل‌ها

```
gradingsystem/
├── page.tsx                    # صفحه اصلی و مدیریت wizard
├── components/
│   ├── ClassSelectionStep.tsx     # انتخاب کلاس
│   ├── SubjectSelectionStep.tsx   # انتخاب درس
│   ├── GradeTitleStep.tsx         # وارد کردن عنوان
│   ├── StudentsGradingStep.tsx    # ثبت نمرات دانش‌آموزان
│   ├── ReviewSaveStep.tsx         # بررسی و ذخیره
│   └── GradeListsView.tsx         # نمایش فهرست نمرات
└── README.md                   # مستندات
```

## API Routes

```
/api/gradingsystem/
├── teacher-classes/           # دریافت کلاس‌های معلم
├── class-subjects/           # دریافت دروس کلاس
├── save-grades/             # ذخیره/ویرایش نمرات
├── grade-lists/            # دریافت فهرست نمرات
└── grade-list/[id]/       # دریافت جزئیات نمره خاص
```

## ساختار دیتابیس

### Collection: `grade_lists`

```javascript
{
  _id: ObjectId,
  title: "آزمون میان‌ترم",
  classCode: "233",
  className: "عناب",
  courseCode: "11021",
  courseName: "ریاضی",
  teacherCode: "200",
  schoolCode: "2295566177",
  gradeCount: 25,
  statistics: {
    average: 15.2,
    passing: 20,
    failing: 5,
    highest: 20,
    lowest: 8,
    total: 25
  },
  createdAt: "2025-01-15T10:30:00Z",
  updatedAt: "2025-01-15T10:30:00Z"
}
```

### Collection: `grades`

```javascript
{
  _id: ObjectId,
  gradeListId: "grade_list_id",
  studentCode: "6519890517",
  studentName: "حسین احمدی",
  score: 18.5,
  classCode: "233",
  courseCode: "11021",
  teacherCode: "200",
  schoolCode: "2295566177",
  createdAt: "2025-01-15T10:30:00Z",
  updatedAt: "2025-01-15T10:30:00Z"
}
```

## نحوه استفاده

### برای معلمان:

1. وارد صفحه سیستم نمره‌دهی شوید
2. روی "ثبت نمره جدید" کلیک کنید
3. کلاس مورد نظر را انتخاب کنید
4. درس مورد نظر را انتخاب کنید
5. عنوان مناسب برای نمره وارد کنید
6. نمرات دانش‌آموزان را وارد کنید
7. نمرات را بررسی و ذخیره کنید

### برای مدیر مدرسه:

1. تمام نمرات ثبت شده توسط معلمان را مشاهده کنید
2. آمار کلی مدرسه را بررسی کنید
3. در صورت نیاز، نمرات را ویرایش کنید

## ویژگی‌های UX

### بهینه‌سازی برای سرعت:

- **فوکوس خودکار**: فوکوس روی اولین فیلد خالی
- **حرکت با کیبورد**: استفاده از کلیدهای میانبر
- **اعتبارسنجی لحظه‌ای**: بررسی فوری ورودی‌ها
- **پیش‌نمایش زنده**: نمایش آمار در حین ورود

### راهنمای کاربر:

- **نوار پیشرفت**: نمایش مرحله فعلی
- **راهنمای سریع**: دستورالعمل‌های کلیدی
- **پیام‌های واضح**: اطلاع‌رسانی مناسب در هر مرحله
- **پیشنهادات**: عناوین پیشنهادی برای نمرات

## امنیت

- **احراز هویت**: بررسی دسترسی در تمام API ها
- **مجوزهای سطحی**: کنترل دقیق دسترسی بر اساس نقش کاربر
- **اعتبارسنجی ورودی**: بررسی تمام داده‌های ورودی
- **حفاظت از CSRF**: استفاده از توکن‌های امنیتی

## توسعه آینده

- [ ] صادرات نمرات به Excel/PDF
- [ ] نمودارهای پیشرفته آماری
- [ ] اعلان‌های خودکار به والدین
- [ ] تحلیل روند پیشرفت دانش‌آموزان
- [ ] قالب‌های مختلف کارنامه
- [ ] پشتیبانی از نمره‌دهی توصیفی

## نصب و راه‌اندازی

سیستم به صورت خودکار با پروژه اصلی نصب می‌شود. فقط کافی است:

1. مطمئن شوید که دیتابیس MongoDB راه‌اندازی شده است
2. Collections مورد نیاز (`classes`, `courses`, `teachers`, `students`) موجود باشند
3. به آدرس `/admin/gradingsystem` مراجعه کنید

## پشتیبانی

برای گزارش مشکلات یا پیشنهادات بهبود، لطفاً با تیم توسعه تماس بگیرید.
